<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Vue3 Test</title>
  <link rel="icon" href="data:;base64,=">
  <link href="./fontawesome/css/fontawesome.min.css" rel="stylesheet" />
  <link href="./fontawesome/css/regular.min.css" rel="stylesheet" />
  <link href="./first_vue.css" rel="stylesheet" />
</head>
<body>
  <script type="importmap">
    {
      "imports": {
        "vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js"
      }
    }
  </script>

  <div id="app">
  </div>

  <script type="module">
    import { createApp, defineAsyncComponent} from 'vue'; //using import map

      createApp({
        data() {
          return {
            workers: [],
            headers: []    
          }
        },
        //define how to import the component
        components: {
            'Table': defineAsyncComponent( () => import('./table_component.js') )
        },
        template: `<Table :headers="headers" :workers="workers" :defaultSortColumn="'name'"></Table>`,
        methods: {
          async getWorkers() {
              const workers = [
                  { name: "Airi Satou", position: "Accountant", office: "Tokyo", age: 33},
                  { name: "Angelica Ramos", position: "Chief Executive Officer", office: "London", age: 47 },
                  { name: "Cedric Kelly", position: "Senior Javascript Developer", office: "Edinburgh", age: 22 },
                  { name: "Jennifer Chang", position: "Regional Director", office: "Singapore", age: 28 },
                  { name: "Brenden Wagner", position: "Key Account Manager", office: "San Francisco", age: 48 },
                  { name: "Fiona Green", position: "Chief Operating Officer (COO)", office: "San Francisco", age: 52 },
                  { name: "Garrett Winters", position: "Senior Accountant", office: "San Francisco", age: 63 },
                  { name: "Gavin Cortez", position: "Team Leader", office: "San Francisco", age: 23 },
                  { name: "Martena Mccray", position: "Post-Sales support", office: "Edinburgh", age: 46 },
                  { name: "Michael Silva", position: "Marketing Designer", office: "London", age: 66 }
              ];

              const headers = [
                  { key: "name", value: "Name" },
                  { key: "position", value: "Position" },
                  { key: "office", value: "Office" },
                  { key: "age", value: "Age" },
              ];

              //make it async to simulate fetching data
              Promise.resolve([workers, headers]).then(([resolvedWorkers, resolvedHeaders]) => {
                  this.workers = resolvedWorkers;
                  this.headers = resolvedHeaders;
              });
          }
        },
        mounted() {
            this.getWorkers();
        }        
      }).mount('#app')
  </script>
  <footer>
    <p>based on <a target="_blank" href="https://dev.to/krowemoh/a-vue3-tutorial-01-using-vue-without-a-build-step-2kkm">this tutorial</a></p>
  </footer>
</body>
</html>
